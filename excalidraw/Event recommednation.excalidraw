{"type":"excalidraw","version":2,"source":"https://app.excalidraw.com","metadata":{"id":"7YweGQ9G1Wv","workspace":"6lsqOkFWqjK","name":"Event recommednation","created":"2025-10-15T01:02:06.496Z","updated":"2025-10-15T01:40:14.669Z","collection":null,"creator":"Alx6QpYT9Vj","updater":"Alx6QpYT9Vj","isPrivate":true,"pinned":false},"elements":[{"id":"Ik6WF6H792ikL8oqf3XGK","type":"text","x":573.99609375,"y":368.8828125,"width":1114.3870849609375,"height":2325,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a0","roundness":null,"seed":463608587,"version":4252,"versionNonce":329144011,"isDeleted":false,"boundElements":[],"updated":1760492410479,"link":null,"locked":false,"text":"CQ\n\n- How many events are in the catalogue? 50-80 upcoming events, \n- Is this a feed ranking based on current location, or search based retrival? Home feed\n- Are these in all different countries? global, multi lingual\n- Events are time sensitive?\n- I assume friends are on the website and we can see and follow them?\n- What type of events are we recommending?\n- KPI: booking # increase guardrail on reports, complain rates, bounce after click?\n- do we have previous user interactions? click, extended view, booking, reports?\n- API for distance and compute diff calculation?\n\nHigh level:\n- Predict the next user visit given the current time and location and history of attendance\n- KPI # of bookings guardrail on report rate, complain rate, and bounce after click\n- User request -> list of ranked probablity of booking\n\nData contruction\n\n- Label:\n-- booking too sparse, click could be click baity, bookmark maybe?\n-- positive: impressed event, user converted, user amount paid\n-- negative: no interaction\n-- label can be a weighted combiniation of engagements, multi head modeling\n\n- Feature engineering:\n- user:\n-- user id, age, gender, previous events (embedding aggregated of ids), payment cluster (cluster id of payments), \n-- genre cluster (sport, etc), user account age, user engamgenet cluster (active, dormany, watching), \n\n- request: request city, recquest TOD, DOW, device, surface (all onehot, or embedding depending on cardinality)\n\n- event id (hash, embedding) event desctiption (distilmbert), event tag BOW, event genre, event, event location:\nwalkability, access to public transportation\n\n- user to user affinity: user friends # of rsvp on event, user friend ratio of rsvp, family RSVP, close friends\nRSVP\n\n- user to event affinity: boolean user bought same genre, user spend on same genre, commute time, user commute\ncomfort cluster (distance and time bucketized), user event DOW X event DOW dot product, attended event from\nprevious host(ratio, boolean), user event price X event price (we can allow model to learn these through feature\ncrosses embedding based) counting them is complicated.\n\n- feature store:\n-- a lot of on the fly computation (optimization, caching, precoputation)\n-- many static features (simple and fast)\n-- complicated for training serving skew\n- - feture decay give higher score to recent activities\n\nModeling architecture\n- we are using IDs (DNN with embedding layers help quite a bit)\n- multi head prediction (simple with DNN)\n- XGBoost can be good, not good with continual learning (good with sparse features)\n- multi task, so MMOE might help, experiment, might not help due to similar tasks\n\nModel training:\n- skew : down sampling, weighted loss training\n- calibration layer: good to have not necessary\n- temporal traing test split to avoid leakage\n\nEvaluation:\noffline:\n- regression so relevance is continuous, we are using NDCG (relevance taking rank into account)\n- we can have a lighter version of the model distilled\n\nonline:\n# booking\nratio of booking\nengaged view rate \nrevenut lift\ngaurdrail complain rate\n\n\nServing\n- real time latency, feature cross is a budget\n- prunning, distillication could help\n- location based filter, light weight model (filter additional request), heavy weight model\n- for intearctions use model to learn embeddings (FM, or DCN)\n- position bias, position as a feature\n- serving bias, exploration rate\n\n\n\nDeployment\n- shadoing, canarying, a/b, hodback, we can also think about multi arm bandint\n\n\n\nMonitoring, logging alerting, contiual learning\n- quality, drift, loss\n- dau, churn rate\n- latency, request count, GPU utlization, failure rate\n- log features for feature skew test.","fontSize":20,"fontFamily":5,"textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"CQ\n\n- How many events are in the catalogue? 50-80 upcoming events, \n- Is this a feed ranking based on current location, or search based retrival? Home feed\n- Are these in all different countries? global, multi lingual\n- Events are time sensitive?\n- I assume friends are on the website and we can see and follow them?\n- What type of events are we recommending?\n- KPI: booking # increase guardrail on reports, complain rates, bounce after click?\n- do we have previous user interactions? click, extended view, booking, reports?\n- API for distance and compute diff calculation?\n\nHigh level:\n- Predict the next user visit given the current time and location and history of attendance\n- KPI # of bookings guardrail on report rate, complain rate, and bounce after click\n- User request -> list of ranked probablity of booking\n\nData contruction\n\n- Label:\n-- booking too sparse, click could be click baity, bookmark maybe?\n-- positive: impressed event, user converted, user amount paid\n-- negative: no interaction\n-- label can be a weighted combiniation of engagements, multi head modeling\n\n- Feature engineering:\n- user:\n-- user id, age, gender, previous events (embedding aggregated of ids), payment cluster (cluster id of payments), \n-- genre cluster (sport, etc), user account age, user engamgenet cluster (active, dormany, watching), \n\n- request: request city, recquest TOD, DOW, device, surface (all onehot, or embedding depending on cardinality)\n\n- event id (hash, embedding) event desctiption (distilmbert), event tag BOW, event genre, event, event location: walkability, access to public transportation\n\n- user to user affinity: user friends # of rsvp on event, user friend ratio of rsvp, family RSVP, close friends RSVP\n\n- user to event affinity: boolean user bought same genre, user spend on same genre, commute time, user commute comfort cluster (distance and time bucketized), user event DOW X event DOW dot product, attended event from previous host(ratio, boolean), user event price X event price (we can allow model to learn these through feature crosses embedding based) counting them is complicated.\n\n- feature store:\n-- a lot of on the fly computation (optimization, caching, precoputation)\n-- many static features (simple and fast)\n-- complicated for training serving skew\n- - feture decay give higher score to recent activities\n\nModeling architecture\n- we are using IDs (DNN with embedding layers help quite a bit)\n- multi head prediction (simple with DNN)\n- XGBoost can be good, not good with continual learning (good with sparse features)\n- multi task, so MMOE might help, experiment, might not help due to similar tasks\n\nModel training:\n- skew : down sampling, weighted loss training\n- calibration layer: good to have not necessary\n- temporal traing test split to avoid leakage\n\nEvaluation:\noffline:\n- regression so relevance is continuous, we are using NDCG (relevance taking rank into account)\n- we can have a lighter version of the model distilled\n\nonline:\n# booking\nratio of booking\nengaged view rate \nrevenut lift\ngaurdrail complain rate\n\n\nServing\n- real time latency, feature cross is a budget\n- prunning, distillication could help\n- location based filter, light weight model (filter additional request), heavy weight model\n- for intearctions use model to learn embeddings (FM, or DCN)\n- position bias, position as a feature\n- serving bias, exploration rate\n\n\n\nDeployment\n- shadoing, canarying, a/b, hodback, we can also think about multi arm bandint\n\n\n\nMonitoring, logging alerting, contiual learning\n- quality, drift, loss\n- dau, churn rate\n- latency, request count, GPU utlization, failure rate\n- log features for feature skew test.","autoResize":false,"lineHeight":1.25},{"id":"mOaPr8TnA6_1ew6tvU1w5","type":"rectangle","x":2030.125,"y":1102.09765625,"width":321.609375,"height":207.3828125,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a2","roundness":{"type":3},"seed":577897925,"version":50,"versionNonce":214267493,"isDeleted":false,"boundElements":[{"id":"I9CbtFuHAGtQsUjM0wzwo","type":"arrow"}],"updated":1760491957672,"link":null,"locked":false},{"id":"ostIFS9l9LNiV7NdSQpU0","type":"text","x":2079.046875,"y":1200.90625,"width":278.9398193359375,"height":50,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a3","roundness":null,"seed":1093613797,"version":102,"versionNonce":1345905771,"isDeleted":false,"boundElements":[],"updated":1760492375891,"link":null,"locked":false,"text":"location based filter\n(also interest, concernt ony)","fontSize":20,"fontFamily":5,"textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"location based filter\n(also interest, concernt ony)","autoResize":true,"lineHeight":1.25},{"id":"I9CbtFuHAGtQsUjM0wzwo","type":"arrow","x":2356.18359375,"y":1197.90625,"width":125.30078125,"height":4.234375,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a4","roundness":{"type":2},"seed":625303653,"version":30,"versionNonce":1449500421,"isDeleted":false,"boundElements":[],"updated":1760491957672,"link":null,"locked":false,"points":[[0,0],[125.30078125,4.234375]],"lastCommittedPoint":null,"startBinding":{"elementId":"mOaPr8TnA6_1ew6tvU1w5","focus":-0.12341148302486335,"gap":4.44921875},"endBinding":null,"startArrowhead":null,"endArrowhead":"arrow","elbowed":false},{"id":"rgSV_6AvWgCMczjIB-1Zx","type":"rectangle","x":2480.6796875,"y":1100.15234375,"width":234.91015625,"height":225.53515625,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a5","roundness":{"type":3},"seed":327741355,"version":70,"versionNonce":52243813,"isDeleted":false,"boundElements":[{"type":"text","id":"f7MitOo9bU8WZmjbtar1M"}],"updated":1760491966263,"link":null,"locked":false},{"id":"f7MitOo9bU8WZmjbtar1M","type":"text","x":2546.394790649414,"y":1200.419921875,"width":103.47994995117188,"height":25,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a6","roundness":null,"seed":455203019,"version":13,"versionNonce":655433451,"isDeleted":false,"boundElements":[],"updated":1760491968481,"link":null,"locked":false,"text":"light model","fontSize":20,"fontFamily":5,"textAlign":"center","verticalAlign":"middle","containerId":"rgSV_6AvWgCMczjIB-1Zx","originalText":"light model","autoResize":true,"lineHeight":1.25},{"id":"Vsv4cTWEk6GR-1qsQAHIb","type":"rectangle","x":2836.50390625,"y":1079.8046875,"width":219.08984375,"height":261.8984375,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a7","roundness":{"type":3},"seed":1048617003,"version":49,"versionNonce":865478245,"isDeleted":false,"boundElements":[{"id":"UJ3k4yHFnGMxFp_9N1zRc","type":"arrow"}],"updated":1760491981491,"link":null,"locked":false},{"id":"6G9BsQ9ML010qkdVC0TN2","type":"text","x":2910,"y":1200,"width":115.29994201660156,"height":25,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a8","roundness":null,"seed":1677053733,"version":13,"versionNonce":1396432805,"isDeleted":false,"boundElements":[],"updated":1760491974603,"link":null,"locked":false,"text":"heavy model","fontSize":20,"fontFamily":5,"textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"heavy model","autoResize":true,"lineHeight":1.25},{"id":"IbHnAk-eh4HJaA2jt97Pl","type":"arrow","x":2707.5390625,"y":1210.8515625,"width":130.86328125,"height":1.34765625,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a9","roundness":{"type":2},"seed":1567226469,"version":36,"versionNonce":1755555851,"isDeleted":false,"boundElements":[{"type":"text","id":"bJnHBsSBheFPL63EXAPYl"}],"updated":1760491995974,"link":null,"locked":false,"points":[[0,0],[130.86328125,-1.34765625]],"lastCommittedPoint":null,"startBinding":null,"endBinding":null,"startArrowhead":null,"endArrowhead":"arrow","elbowed":false},{"id":"bJnHBsSBheFPL63EXAPYl","type":"text","x":2721.09073638916,"y":1197.677734375,"width":103.75993347167969,"height":25,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"a9V","roundness":null,"seed":1241598949,"version":20,"versionNonce":288081765,"isDeleted":false,"boundElements":[],"updated":1760491995187,"link":null,"locked":false,"text":">80% click","fontSize":20,"fontFamily":5,"textAlign":"center","verticalAlign":"middle","containerId":"IbHnAk-eh4HJaA2jt97Pl","originalText":">80% click","autoResize":true,"lineHeight":1.25},{"id":"UJ3k4yHFnGMxFp_9N1zRc","type":"arrow","x":3057.83203125,"y":1206.296875,"width":93.2578125,"height":0.37109375,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"index":"aA","roundness":{"type":2},"seed":117329541,"version":24,"versionNonce":898387717,"isDeleted":false,"boundElements":[],"updated":1760491981491,"link":null,"locked":false,"points":[[0,0],[93.2578125,-0.37109375]],"lastCommittedPoint":null,"startBinding":{"elementId":"Vsv4cTWEk6GR-1qsQAHIb","focus":-0.030537862567589023,"gap":2.23828125},"endBinding":null,"startArrowhead":null,"endArrowhead":"arrow","elbowed":false}],"appState":{"viewBackgroundColor":"#ffffff","lockedMultiSelections":{}},"files":{}}